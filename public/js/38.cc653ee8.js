(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{ba30:function(a,e,t){"use strict";t.r(e);t("a4d3"),t("e01a");var i=function(){var a=this,e=a._self._c;return e("q-page",[e("q-header",[e("q-toolbar",[e("q-btn",{directives:[{name:"go-back",rawName:"v-go-back.single",modifiers:{single:!0}}],attrs:{flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),e("q-toolbar-title",[a._v("\n        Edit Produk\n      ")])],1)],1),e("q-form",{on:{submit:function(e){return e.preventDefault(),a.submit.apply(null,arguments)}}},[e("div",{staticClass:"q-pa-md q-gutter-y-sm"},[e("q-input",{attrs:{filled:"",type:"text",label:"Nama Produk",rules:[function(a){return a&&""!=a||"Nama produk harus diisi"}]},model:{value:a.form.title,callback:function(e){a.$set(a.form,"title",e)},expression:"form.title"}}),e("q-input",{attrs:{filled:"",required:"",label:"Harga",prefix:"Rp"},model:{value:a.form.price_custom_label,callback:function(e){a.$set(a.form,"price_custom_label",e)},expression:"form.price_custom_label"}}),e("q-checkbox",{attrs:{label:"Produk Tersedia?"},model:{value:a.form.is_available,callback:function(e){a.$set(a.form,"is_available",e)},expression:"form.is_available"}}),e("q-select",{staticClass:"q-pb-md",attrs:{filled:"",options:a.categories,label:"Kategori","emit-value":"","map-options":""},model:{value:a.form.category_id,callback:function(e){a.$set(a.form,"category_id",e)},expression:"form.category_id"}}),e("div",{staticClass:"q-mt-md q-mb-sm"},[e("label",{staticClass:"text-grey-7 q-pb-sm block",attrs:{for:"description"}},[a._v("Deskripsi")]),e("q-editor",{model:{value:a.form.description,callback:function(e){a.$set(a.form,"description",e)},expression:"form.description"}}),a.errors.description?e("div",{staticClass:"text-xs text-red"},[a._v(" "+a._s(a.errors.description[0]))]):a._e()],1),e("section",{staticClass:"q-my-md q-gutter-y-sm",attrs:{id:"image-section"}},[e("div",[e("q-btn",{staticClass:"mt-2 mr-2",attrs:{label:"Upload Gambar Produk",size:"sm",color:"primary",icon:"eva-upload",type:"button"},on:{click:function(e){return e.preventDefault(),a.selectNewImage.apply(null,arguments)}}}),e("input",{ref:"image",staticClass:"hidden",attrs:{type:"file",multiple:""},on:{change:a.updateImagePreview}})],1),a.form.images.length?e("div",{staticClass:"q-mt-md",attrs:{separator:""}},[e("draggable",{model:{value:a.form.images,callback:function(e){a.$set(a.form,"images",e)},expression:"form.images"}},[e("transition-group",a._l(a.form.images,(function(t,i){return e("div",{key:i,staticClass:"cursor-pointer q-pa-xs"},[e("div",{staticClass:"row justify-between items-center box-img-bordered q-px-sm q-py-xs relative",class:{"img-featured":0==i}},[0==i?e("div",{staticClass:"featured-badge"},[a._v("Featured")]):a._e(),e("div",{staticClass:"row items-center q-gutter-x-sm"},[e("div",[a._v(a._s(i+1))]),e("img",{staticClass:"bg-white",staticStyle:{width:"100px",height:"70px","object-fit":"contain"},attrs:{src:t.src}})]),e("q-btn",{attrs:{icon:"delete",round:"",unelevated:"",color:"red",dense:""},on:{click:function(e){return a.handleRemoveImage(t)}}})],1)])})),0)],1)],1):a._e()])],1),e("div",{attrs:{id:"variants"}},[a.form.varians.length?e("div",[a.form.varians[0].has_subvarian?e("div",a._l(a.form.varians,(function(t,i){return e("div",{key:i},[e("div",{staticClass:"row items-start justify-between q-pa-md q-pt-lg"},[e("div",{staticClass:"text-weight-bold text-md"},[a._v(a._s(a.form.varians[i].label)+" "+a._s(a.form.varians[i].value)+"\n              ")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",size:"10px",color:"red"},on:{click:function(e){return a.deleteVarian(i,t)}}},[a._v("Hapus "+a._s(a.form.varians[i].value))]),e("q-btn",{attrs:{unelevated:"",size:"10px",color:"teal"},on:{click:function(e){return a.pushSubVarian(i)}}},[a._v("Tambah Item")])],1)]),e("div",{},[a.form.varians[i].subvarian.length?e("q-list",{staticClass:"bg-white q-pa-sm q-mt-xs"},a._l(a.form.varians[i].subvarian,(function(t,r){return e("q-item",{key:r,staticClass:"q-px-sm"},[e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",unelevated:"",padding:"2px",icon:"remove",size:"9px",color:"red"},on:{click:function(e){return a.deleteSubvarian(i,r,t)}}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.form.varians[i].subvarian[r].label},model:{value:a.form.varians[i].subvarian[r].value,callback:function(e){a.$set(a.form.varians[i].subvarian[r],"value",e)},expression:"form.varians[varIndex].subvarian[subIndex].value"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Tambahan Harga",mask:"###########"},model:{value:a.form.varians[i].subvarian[r].price,callback:function(e){a.$set(a.form.varians[i].subvarian[r],"price",e)},expression:"form.varians[varIndex].subvarian[subIndex].price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",mask:"######"},model:{value:a.form.varians[i].subvarian[r].stock,callback:function(e){a.$set(a.form.varians[i].subvarian[r],"stock",e)},expression:"form.varians[varIndex].subvarian[subIndex].stock"}})],1)],1)})),1):a._e()],1)])})),0):e("div",[e("div",{staticClass:"row items-start justify-between q-pa-md q-pt-lg"},[e("div",{staticClass:"text-weight-bold text-md"},[a._v(a._s(a.form.varians[0].label)+" ")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",size:"10px",color:"teal"},on:{click:a.pushVarian}},[a._v("Tambah Item")])],1)]),e("q-list",[e("q-list",{staticClass:"q-pa-sm q-mt-xs"},a._l(a.form.varians,(function(t,i){return e("q-item",{key:i},[e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",unelevated:"",padding:"2px",icon:"remove",size:"9px",color:"red"},on:{click:function(e){return a.deleteVarian(i,t)}}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.form.varians[i].label},model:{value:a.form.varians[i].value,callback:function(e){a.$set(a.form.varians[i],"value",e)},expression:"form.varians[vIndex].value"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Tambahan Harga",mask:"###########"},model:{value:a.form.varians[i].price,callback:function(e){a.$set(a.form.varians[i],"price",e)},expression:"form.varians[vIndex].price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",mask:"######"},model:{value:a.form.varians[i].stock,callback:function(e){a.$set(a.form.varians[i],"stock",e)},expression:"form.varians[vIndex].stock"}})],1)],1)})),1)],1)],1)]):a._e()]),e("q-footer",{staticClass:"bg-transparent q-pa-md"},[e("q-btn",{staticClass:"full-width",attrs:{color:"primary",type:"submit",loading:a.loading,label:"Simpan Data"}},[e("q-tooltip",{staticClass:"bg-accent"},[a._v("Simpan Data")])],1)],1)],1),e("q-dialog",{model:{value:a.varianModal,callback:function(e){a.varianModal=e},expression:"varianModal"}},[e("q-card",{staticClass:"card-medium"},[e("div",{staticClass:"card-heading"},[a._v("Tambah varian")]),e("q-form",{on:{submit:function(e){return e.preventDefault(),a.addVarianProduk.apply(null,arguments)}}},[e("q-card-section",[e("div",[e("div",{staticClass:"text-md"},[a._v("Varian")]),e("q-input",{attrs:{label:"Label",placeholder:"contoh: Ukuran"},model:{value:a.tempVarian.label,callback:function(e){a.$set(a.tempVarian,"label",e)},expression:"tempVarian.label"}}),e("q-input",{attrs:{label:"Item",placeholder:"contoh: Small, Medium, Large"},model:{value:a.tempVarian.value,callback:function(e){a.$set(a.tempVarian,"value",e)},expression:"tempVarian.value"}}),e("div",{staticClass:"text-grey-7 text-xs q-py-xs"},[a._v("Untuk multiple item, gunakan sparator koma")])],1),a.canToggleSubvarian?e("div",[e("q-checkbox",{attrs:{label:"Subvarian?"},model:{value:a.form.has_subvarian,callback:function(e){a.$set(a.form,"has_subvarian",e)},expression:"form.has_subvarian"}})],1):a._e(),a.mustHaveSubvarian?e("div",{staticClass:"q-mt-md"},[e("div",{staticClass:"text-md"},[a._v("Subvarian")]),e("q-input",{attrs:{label:"Label",placeholder:"contoh: Warna"},model:{value:a.tempSubvarian.label,callback:function(e){a.$set(a.tempSubvarian,"label",e)},expression:"tempSubvarian.label"}}),e("q-input",{attrs:{label:"Item",placeholder:"contoh: Merah, Biru, Ungu"},model:{value:a.tempSubvarian.value,callback:function(e){a.$set(a.tempSubvarian,"value",e)},expression:"tempSubvarian.value"}}),e("div",{staticClass:"text-grey-7 text-xs q-py-xs"},[a._v("Untuk multiple item, gunakan sparator koma")])],1):a._e(),e("div",{staticClass:"flex justify-end q-mt-md q-gutter-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Tutup",flat:"",color:"primary"}}),e("q-btn",{attrs:{unelevated:"",label:"Tambah",type:"submit",color:"primary"}})],1)])],1)],1)],1)],1)},r=[],s=t("ded3"),n=t.n(s),o=(t("4de4"),t("a434"),t("ac1f"),t("1276"),t("159b"),t("d3b7"),t("e6cf"),t("a79d"),t("2f62")),l=t("6f97"),u=t("b76a"),c=t.n(u),m={name:"ProductFormEdit",components:{draggable:c.a},data:function(){return{varianModal:!1,tempVarian:{label:"",value:""},tempSubvarian:{label:"",value:"",stock:"",is_preorder:!1,price:"",sku:"",items:""},requiredRules:[function(a){return a&&a.length>0||"Field harus diisi."}],product:null,form:{id:"",title:"",price:"",weight:"",stock:"",category_id:"",description:"",varians:[],images:[],del_images:[],has_subvarian:!1,remove_varian:[],remove_subvarian:[],is_available:!1,price_custom_label:""},imagePreview:[],oldImages:[],variantModalForm:!1,productOldImages:[],chatOptions:[]}},computed:{errors:function(){return this.$store.state.errors},loading:function(){return this.$store.state.loading},categories:function(){return this.$store.getters["category/getValueOptions"]},canToggleSubvarian:function(){return!this.form.varians.length||!this.form.varians[0].has_subvarian},mustHaveSubvarian:function(){return!(!this.form.varians.length||!this.form.varians[0].has_varian)||!!this.form.has_subvarian},canAddVarian:function(){return!(this.form.varians.length&&!this.form.varians[0].has_subvarian)}},methods:n()(n()(n()({},Object(o["b"])("product",["productUpdate","getProductById"])),Object(o["b"])("category",["getCategories"])),{},{onUpdateImage:function(a){this.form.product_images.push(a)},onDeleteProductOldImage:function(a){this.productOldImages=this.productOldImages.filter((function(e){return e.filename!=a})),this.form.del_product_images.push(a)},onDeleteImage:function(a){this.form.product_images.splice(a,1)},deleteVarian:function(a,e){var t=this;this.$q.dialog({title:"Yakin akan menghapus data?",cancel:!0}).onOk((function(){t.form.varians.splice(a,1),t.form.remove_varian.push(e.id)}))},deleteSubvarian:function(a,e,t){this.form.remove_subvarian.push(t.id),this.form.varians[a].subvarian.splice(e,1),this.form.varians[a].subvarian.length||this.form.varians.splice(a,1)},pushSubVarian:function(a){var e=this.form.varians[a],t={label:e.subvarian[0].label,value:"",stock:0,price:0};this.form.varians[a].subvarian.push(t)},pushVarian:function(){this.form.varians.push({has_subvarian:!1,label:this.form.varians[0].label,value:"",stock:0,price:0})},addVarianProduk:function(){var a=this,e=this.tempVarian.value.split(",");this.form.has_subvarian?e.forEach((function(e){var t=null;t={has_subvarian:!0,label:a.tempVarian.label,value:e,subvarian:[]};var i=a.tempSubvarian.value.split(",");i.forEach((function(e){var i={label:a.tempSubvarian.label,value:e,stock:0,price:0};t.subvarian.push(i)})),a.form.varians.push(t)})):e.forEach((function(e){var t=null;t={has_subvarian:!1,label:a.tempVarian.label,value:e,stock:0,price:0},a.form.varians.push(t)})),this.varianModal=!1},handleAddVarian:function(){this.varianModal=!0},submit:function(){this.productUpdate(this.form)},selectNewImage:function(){this.$refs.image.click()},updateImagePreview:function(){for(var a=this,e=this.$refs.image.files,t=new FormData,i=0;i<e.length;i++)t.append("images["+i+"]",e[i]);this.$q.loading.show({message:"Uploading, Please Wait...",backgroundColor:"white",messageColor:"primary",spinnerColor:"primary"}),Object(l["a"])().post("assets",t,{headers:{"content-Type":"multipart/formData"}}).then((function(e){200==e.status&&e.data.results.forEach((function(e){a.form.images.push(e)}))})).finally((function(){a.$q.loading.hide()}))},removeLocalImage:function(a){this.imagePreview=this.imagePreview.filter((function(e,t){return t!==a})),this.form.images=this.form.images.filter((function(e,t){return t!==a}))},handleRemoveImage:function(a){var e=this;this.$q.loading.show({message:"Please Wait...",backgroundColor:"white",messageColor:"primary",spinnerColor:"primary"}),Object(l["a"])().delete("assets/"+a.id).then((function(t){200==t.status&&(e.form.images=e.form.images.filter((function(e){return e.filename!=a.filename})))})).finally((function(){e.$q.loading.hide()}))},setData:function(){this.form.id=this.product.id,this.form.title=this.product.title,this.form.price=this.product.custom,this.form.price_custom_label=this.product.price_custom_label,this.form.category_id=this.product.category_id,this.form.description=this.product.description,this.form.is_available=!!this.product.is_available,this.form.images=this.product.assets}}),mounted:function(){var a=this;this.getProductById(this.$route.params.id).then((function(e){a.product=e.data.results,a.setData()})),this.getCategories()}},d=m,v=t("2877"),p=t("9989"),f=t("e359"),b=t("65c6"),h=t("9c40"),g=t("6ac5"),q=t("0378"),k=t("27f9"),_=t("8f8e"),x=t("ddd8"),y=t("d66b"),C=t("1c1c"),w=t("66e5"),I=t("4074"),S=t("7ff0"),$=t("05c0"),V=t("24e8"),P=t("f09f"),Q=t("a370"),T=t("2eeb"),D=t("7f67"),O=t("eebe"),j=t.n(O),M=Object(v["a"])(d,i,r,!1,null,null,null);e["default"]=M.exports;j()(M,"components",{QPage:p["a"],QHeader:f["a"],QToolbar:b["a"],QBtn:h["a"],QToolbarTitle:g["a"],QForm:q["a"],QInput:k["a"],QCheckbox:_["a"],QSelect:x["a"],QEditor:y["a"],QList:C["a"],QItem:w["a"],QItemSection:I["a"],QFooter:S["a"],QTooltip:$["a"],QDialog:V["a"],QCard:P["a"],QCardSection:Q["a"]}),j()(M,"directives",{GoBack:T["a"],ClosePopup:D["a"]})}}]);