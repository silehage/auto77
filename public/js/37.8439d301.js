(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{d09f:function(t,e,o){"use strict";o.r(e);o("ac1f"),o("841c");var i=function(){var t=this,e=t._self._c;return e("q-page",[e("q-header",[e("q-toolbar",[e("q-btn",{attrs:{to:{name:"PromoIndex",query:{q:"promo"}},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),t.promo?e("q-toolbar-title",[t._v("\n       "+t._s(t.promo.label)+"\n      ")]):t._e(),e("q-btn",{attrs:{unelevated:"",color:"accent"},on:{click:t.handleAddProductPromo}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v("Produk")])],1)],1)],1),t.promo?e("div",[e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",[t._v("Label")]),e("q-item-section",{attrs:{side:""}},[t._v(t._s(t.promo.label))])],1),e("q-item",[e("q-item-section",[t._v("Start")]),e("q-item-section",{attrs:{side:""}},[t._v(t._s(t.promo.start))])],1),e("q-item",[e("q-item-section",[t._v("Selesai")]),e("q-item-section",{attrs:{side:""}},[t._v(t._s(t.promo.start))])],1),e("q-item",[e("q-item-section",[t._v("Status")]),e("q-item-section",{attrs:{side:""}},[e("span",{staticClass:"q-px-md q-py-xs rounded-borders text-white",class:t.promo.is_active?"bg-green":"bg-grey-7"},[t._v(t._s(t.promo.is_active?"Active":"Inactive"))])])],1)],1),e("q-separator")],1):t._e(),t.promo?e("div",[e("div",{staticClass:"row items-center justify-between q-pa-md",class:t.$q.dark.isActive?"bg-grey-7 text-white":"bg-grey-2"},[e("div",{staticClass:"text-md text-weight-bold"},[t._v("Total Produk "+t._s(t.products.length))])]),e("div",{},[t.products.length?e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",{attrs:{side:""}},[t._v("#")]),e("q-item-section",[t._v("Nama Produk")]),e("q-item-section",[t._v("Diskon")]),e("q-item-section",{attrs:{side:""}},[t._v("Actions")])],1),t._l(t.products,(function(o,i){return e("q-item",{key:i},[e("q-item-section",{attrs:{side:""}},[t._v(t._s(i+1))]),e("q-item-section",[t._v(t._s(o.title))]),e("q-item-section",[t._v(t._s("PERCENT"==o.pivot.discount_type?o.pivot.discount_amount+" %":t.moneyIDR(o.pivot.discount_amount)))]),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"q-gutter-sm flex"},[e("q-btn",{attrs:{icon:"eva-edit-2",unelevated:"",round:"",size:"11px",color:"blue",disabled:t.syncLoading},on:{click:function(e){return t.handleEdit(o)}}}),e("q-btn",{attrs:{icon:"eva-trash-2",size:"11px",round:"",unelevated:"",color:"red",disabled:t.syncLoading},on:{click:function(e){return t.handleRemoveProductPromo(o.id)}}})],1)])],1)}))],2):t._e()],1)]):t._e(),e("q-dialog",{attrs:{persistent:"",position:"bottom"},model:{value:t.searchModal,callback:function(e){t.searchModal=e},expression:"searchModal"}},[e("q-card",{staticClass:"max-width"},[e("div",{staticClass:"sticky-top"},[e("div",{staticClass:"flex justify-between items-center card-heading"},[e("div",{},[t._v("Produk Promo")]),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",round:"",padding:"0px",flat:""}})],1),e("div",{staticClass:"q-px-md q-py-md box-shadow"},[e("q-input",{attrs:{outlined:"",placeholder:"Cari",dense:"",debounce:700,type:"search",clearable:""},on:{input:t.findProduct,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.findProduct.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),e("q-card-section",{staticClass:"q-gutter-y-sm",staticStyle:{"min-height":"250px","overflow-y":"auto"}},[t.productSearch.length?e("div",[e("q-list",{attrs:{separator:""}},t._l(t.productSearch,(function(o){return e("q-item",{key:o.id,attrs:{clickable:""},on:{click:function(e){return t.syncProduct(o)}}},[e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{icon:"check_box",padding:"0px",unelevated:"",size:"12px"}})],1),e("q-item-section",[t._v(t._s(o.title))])],1)})),1)],1):t._e(),e("q-inner-loading",{attrs:{showing:t.isLoading}}),t.isLoading||t.productSearch.length?t._e():e("div",{staticClass:"text-center q-pt-lg"},[t._v("Tidak ada data ditemukan")])],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.productPromoModal,callback:function(e){t.productPromoModal=e},expression:"productPromoModal"}},[t.productSelected?e("q-card",{staticClass:"card-medium"},[e("q-card-section",[e("div",{staticClass:"text-md text-weight-bold q-mb-md"},[t._v("Produk "+t._s(t.productSelected.title))]),e("q-form",{on:{submit:function(e){return e.preventDefault(),t.submitProductPromo.apply(null,arguments)}}},[e("div",{staticClass:"flex items-center q-mt-sm full-width q-gutter-x-sm"},[e("q-input",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Nominal",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_amount,callback:function(e){t.$set(t.form,"discount_amount",e)},expression:"form.discount_amount"}}),e("q-select",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Tipe",options:t.discountTypeOptions,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}})],1),e("div",{staticClass:"flex justify-end q-gutter-x-sm q-mt-md"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",outline:"",color:"primary"}}),e("q-btn",{attrs:{type:"submit",label:"Submit",unelevated:"",color:"primary"}})],1)])],1)],1):t._e()],1)],1)},s=[],a=(o("d3b7"),o("e6cf"),o("a79d"),o("758b")),r={name:"ProductPromo",data:function(){return{productPromoModal:!1,productSelected:null,product_ids:[],promo:null,isLoading:!1,syncLoading:!1,searchModal:!1,search:"",productSearch:[],products:[],form:{promo_id:null,product_id:null,discount_amount:0,discount_type:"PERCENT"},discountTypeOptions:[{value:"PERCENT",label:"Persen"},{value:"AMOUNT",label:"Nominal"}],removeId:null}},methods:{getPromoDetail:function(){var t=this;Object(a["a"])().get("getPromoDetail/"+this.$route.params.id).then((function(e){200==e.status&&(t.products=e.data.results.products,t.promo=e.data.results.promo)}))},getProductPromo:function(){var t=this;Object(a["a"])().get("getProductPromo/"+this.$route.params.id).then((function(e){200==e.status&&(t.products=e.data.results)}))},findProduct:function(){var t=this;this.search&&(this.isLoading=!0,this.productSearch=[],Object(a["a"])().get("findProductWithoutPromo/"+this.search).then((function(e){200==e.status&&(t.productSearch=e.data.results)})).finally((function(){t.isLoading=!1})))},handleEdit:function(t){this.productSelected=t,this.form.product_id=t.id,this.form.promo_id=this.promo.id,this.form.discount_amount=t.pivot.discount_amount,this.form.discount_type=t.pivot.discount_type,this.productPromoModal=!0},handleAddProductPromo:function(){this.search="",this.searchModal=!0,this.productSearch=[]},syncProduct:function(t){this.productSelected=t,this.form.product_id=t.id,this.form.promo_id=this.promo.id,this.searchModal=!1,this.productPromoModal=!0},submitProductPromo:function(){var t=this;"PERCENT"==this.form.discount_type&&(0==this.form.discount_amount||this.form.discount_amount>=99)?this.$q.notify({type:"negative",message:"Tentukan nilai nominal diskon dengan benar"}):Object(a["a"])().post("submitProductPromo",this.form).then((function(){t.getProductPromo()})).finally((function(){return t.productPromoModal=!1}))},handleRemoveProductPromo:function(t){var e=this;this.removeId=t,this.$q.dialog({title:"Konnfirmasi",message:"Yakin akan menghapus data?",cancel:!0}).onOk((function(){e.removeProductPromo()}))},removeProductPromo:function(){var t=this;Object(a["a"])().post("removeProductPromo",{promo_id:this.promo.id,product_id:this.removeId}).then((function(){return t.getProductPromo()}))}},mounted:function(){this.getPromoDetail()}},n=r,c=o("2877"),d=o("9989"),u=o("e359"),l=o("65c6"),m=o("9c40"),p=o("6ac5"),h=o("0016"),v=o("1c1c"),f=o("66e5"),q=o("4074"),_=o("eb85"),b=o("24e8"),P=o("f09f"),g=o("27f9"),y=o("a370"),k=o("74f7"),x=o("0378"),C=o("ddd8"),w=o("7f67"),S=o("eebe"),Q=o.n(S),M=Object(c["a"])(n,i,s,!1,null,null,null);e["default"]=M.exports;Q()(M,"components",{QPage:d["a"],QHeader:u["a"],QToolbar:l["a"],QBtn:m["a"],QToolbarTitle:p["a"],QIcon:h["a"],QList:v["a"],QItem:f["a"],QItemSection:q["a"],QSeparator:_["a"],QDialog:b["a"],QCard:P["a"],QInput:g["a"],QCardSection:y["a"],QInnerLoading:k["a"],QForm:x["a"],QSelect:C["a"]}),Q()(M,"directives",{ClosePopup:w["a"]})}}]);